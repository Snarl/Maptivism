<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0" />
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
		<title>Maptivism | Cartography is Cool.</title>
		<link rel="stylesheet" href="../css/master.css" type="text/css" media="screen" title="no title" charset="utf-8">
		<script type="text/javascript" src="../js/jquery-1.4.4.js"></script>
		<script type="text/javascript" src="../js/ticker-1.2.js"></script>
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
		<script type="text/javascript">
			var defaultloc = new google.maps.LatLng(51.50348, -0.126901);
			var currloc = null;
			var map;
			var me = null;
			var followMe = true;

			function init() {
				getTickerRSS();
				map = new google.maps.Map(
					document.getElementById('map'), {
						zoom: 16,
						center: defaultloc,
						mapTypeId: google.maps.MapTypeId.ROADMAP,
						draggable: true
					}
				);
				mapviewlayer = new google.maps.KmlLayer('http://maps.google.co.uk/maps/ms?authuser=0&vps=5&hl=en&ie=UTF8&msa=0&output=kml&msid=212377250988774351922.0004b6224ba561ebee1b0',
					{
						map: map,
						preserveViewport: true,
						clickable: true
					}
				);
				mapviewlayer = new google.maps.KmlLayer('http://maps.google.co.uk/maps/ms?authuser=0&vps=3&hl=en&ie=UTF8&msa=0&output=kml&msid=212377250988774351922.0004ba74e92f1c118c517',
					{
						map: map,
						preserveViewport: true,
						clickable: true
					}
				);
				
				mapviewlayer = new google.maps.KmlLayer('http://maps.google.co.uk/maps/ms?authuser=0&vps=6&hl=en&ie=UTF8&msa=0&output=kml&msid=212377250988774351922.0004ba7516a1ac1e05ac9',
					{
						map: map,
						preserveViewport: true,
						clickable: true
					}
				);
				
				mapviewlayer = new google.maps.KmlLayer('http://maps.google.co.uk/maps/ms?authuser=0&vps=2&hl=en&ie=UTF8&msa=0&output=kml&msid=212377250988774351922.0004ba75119e1444481ff',
					{
						map: map,
						preserveViewport: true,
						clickable: true
					}
				);
				
				mapviewlayer = new google.maps.KmlLayer('http://maps.google.co.uk/maps/ms?authuser=0&vps=7&hl=en&ie=UTF8&msa=0&output=kml&msid=212377250988774351922.0004ba7504886c2262b6a',
					{
						map: map,
						preserveViewport: true,
						clickable: true
					}
				);												

				mapviewlayer = new google.maps.KmlLayer('http://maps.google.co.uk/maps/ms?authuser=0&vps=7&hl=en&ie=UTF8&msa=0&output=kml&msid=212377250988774351922.0004ba7504886c2262b6a',
					{
						map: map,
						preserveViewport: true,
						clickable: true
					}
				);
				
				if (navigator.geolocation) {
					navigator.geolocation.watchPosition(
						locateSuccess,
						locateError, {
							enableHighAccuracy: true, maximumAge: 300*1000, timeout: 290*1000
						}
					);
				} else locateError();
			}

			function locateError() {
				if (currloc === null) {
					currloc = defaultloc;
				}
			}

			function locateSuccess(pos) {
				currloc = new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
				if (me === null) {
					var bounds = new google.maps.LatLngBounds(defaultloc, defaultloc);
					bounds.extend(currloc);
					map.fitBounds(bounds);
					me = new google.maps.Marker({
						map: map,
						draggable: false,
						animation: google.maps.Animation.DROP,
						position: currloc
					});
				}
				if(followMe) {
					map.setCenter(currloc);
					followMe = false;
				}

			}
			</script>
</head>

<body onload="init()">
	<div id="container" align="left" style="margin-top:4px;">
		<div id="ticker"></div>
	</div>
	<div id="occupy" onclick="location.href='http://map.occupylsx.org/';"></div>
	<div id="map"></div>
	<div id="footer" align="center">
		<p>Maptivism &#169;&#824; 2012.</p>
	</div>
</body> 
</html> 
